<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="XtSsjjy">

	<select id="select_noSignIn_count" parameterType="java.util.Map"
		resultType="java.lang.Integer">
		SELECT count(1) from XT_SSJJY where ssid = #{ssid} and
		zt='1' and ( zb = '' or zb is null )
	</select>

	<select id="select_noSignIn_list" parameterType="java.util.Map"
		resultType="cn.hegrace.www.v1.dao.pojo.XtJjry">
		SELECT jj.* from XT_SSJJY ssjj, XT_JJRY jj where ssjj.ryid =
		jj.id and ssjj.ssid = #{ssid} and ssjj.zt = '1' and ( zb = '' or zb is
		null )
		order by jj.xm asc
		limit ${startPage}, ${page}
	</select>
	
	<select id="select_getJjryLngLats_list" parameterType="java.util.Map"
		resultType="cn.hegrace.www.v1.dto.XtSsjjyDto">
		SELECT jjy.* ,ry.xm, ry.dh,
		group_concat(jjysb.sbid separator '|') as sbid,
		group_concat(jl.id separator '|') as jlid
		FROM XT_SSJJY jjy
		left join XT_JJRY ry on ry.id = jjy.ryid and ry.zt = '1'
		left join XT_SSJJYSB jjysb on jjysb.ssjjyid = jjy.id and jjysb.zt = '1'
		left join XT_SSJL jl on jl.ryid = jjy.ryid and jl.ssid = #{ssid} and jl.zt in ('0','1')
		where jjy.zt = '1' and jjy.ssid = #{ssid} and jjy.zb != ''
		group by jjy.id
	</select>

</mapper>